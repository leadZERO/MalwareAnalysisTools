import re
from os import listdir
from os.path import isfile, join
import binascii
import sys

def findAllEncodedUrls(path):
	af = ""
	with open(path, "rb") as f:
		af = f.read()

	allUrls = list()

	for m in re.finditer(br'(?P<enc>6800740074007000([0-9a-fA-F][0-9a-fA-F]00)+?)(00|20)00', af):
		allUrls.append(binascii.unhexlify(m['enc'].replace(b'00', b'')).decode('ascii'))

	return allUrls

def processFile(path):
	urls = findAllEncodedUrls(path)
	for u in urls:
		print(path + ": " + u)

def processDir(path):
	for f in [f for f in listdir(path) if isfile(join(path, f))]:
		processFile(join(path, f))

def main():
	for a in sys.argv:
		if isfile(a):
			processFile(a)
		else:
			processDir(a)


if __name__ == "__main__":
	main()
